source("R/networkplot.R")
data <- read_def("Data/DE.xlsx")
ref <- "GEM"
df <- gen_network_data(data, ref)
View(data)
?read.xlsx
read_def <- function(path){
openxlsx::read.xlsx(path, sheet = "DEF", startRow = 2)
}
source("R/networkplot.R")
library(dplyr)
library(tidyr)
library(ggraph)
library(igraph)
source("R/utils.R")
source("R/network_functions.R")
data <- read_def("Data/DE.xlsx")
ref <- "GEM"
df <- gen_network_data(data, ref)
View(data)
openxlsx::read.xlsx(path, sheet = "DEF", startRow = 1)
read_def <- function(path){
openxlsx::read.xlsx(path, sheet = "DEF", startRow = 1)
}
data <- read_def("Data/DE.xlsx")
View(data)
read_def <- function(path){
openxlsx::read.xlsx(path, sheet = "DEF", startRow = 3)
}
data <- read_def("Data/DE.xlsx")
View(data)
read_def <- function(path){
openxlsx::read.xlsx(path, sheet = "DEF", startRow = 2)
}
data <- read_def("Data/DE.xlsx")
View(data)
ref <- "GEM"
df <- gen_network_data(data, ref)
net <- gen_network(df, ref)
plot(net)
gen_network_data <- function(data, ref){
data %>% select(Study, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, `Median.OS.(Trt.1)`, `Median.OS.(Trt.2)`) %>%
rename(N = Total.Patients) %>%
pivot_longer(cols = 3:4, values_to = "Treatment") %>%
mutate(r = ifelse(Treatment == ref, `N.(Trt1)`, `N.(Trt2)`)) %>%
select(-c(name, `N.(Trt1)`, `N.(Trt2)`, `Median.OS.(Trt.1)`, `Median.OS.(Trt.2)`))
}
data <- read_def("Data/DE.xlsx")
ref <- "GEM"
df <- gen_network_data(data, ref)
gen_network_data <- function(data, ref){
data %>% select(Study, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, `Median.OS.(Trt.1)`, `Median.OS.(Trt.2)`) %>%
rename(N = Total.Patients) %>%
pivot_longer(cols = 3:4, values_to = "Treatment") %>%
mutate(r = ifelse(Treatment == ref, `N.(Trt1)`, `N.(Trt2)`)) %>%
select(-c(name, `N.(Trt1)`, `N.(Trt2)`))
}
df <- gen_network_data(data, ref)
gen_network_data <- function(data, ref){
data %>% select(Study, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, Reported.OS, Reported.PFS) %>%
rename(N = Total.Patients) %>%
pivot_longer(cols = 3:4, values_to = "Treatment") %>%
mutate(r = ifelse(Treatment == ref, `N.(Trt1)`, `N.(Trt2)`)) %>%
select(-c(name, `N.(Trt1)`, `N.(Trt2)`))
}
df <- gen_network_data(data, ref)
df <- gen_network_data(data, ref)
View(df)
OS_network <- df %>%
filter(Reported.OS == 1) %>%
gen_network(ref)
plot(OS_network)
gen_network_data <- function(data, ref){
data %>% select(Study, Year, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, Reported.OS, Reported.PFS) %>%
rename(N = Total.Patients) %>%
mutate(Study = paste0(Study, ", ", Year)) %>%
pivot_longer(cols = 3:4, values_to = "Treatment") %>%
mutate(r = ifelse(Treatment == ref, `N.(Trt1)`, `N.(Trt2)`)) %>%
select(-c(name, `N.(Trt1)`, `N.(Trt2)`))
}
df <- gen_network_data(data, ref)
gen_network_data <- function(data, ref){
data %>% select(Study, Year, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, Reported.OS, Reported.PFS) %>%
rename(N = Total.Patients) %>%
mutate(Study = paste0(Study, ", ", Year))}
df <- gen_network_data(data, ref)
View(df)
gen_network_data <- function(data, ref){
data %>% select(Study, Year, Total.Patients, Treatment.1, Treatment.2, `N.(Trt1)`, `N.(Trt2)`, Reported.OS, Reported.PFS) %>%
rename(N = Total.Patients) %>%
mutate(Study = paste0(Study, ", ", Year)) %>%
pivot_longer(cols = 4:5, values_to = "Treatment") %>%
mutate(r = ifelse(Treatment == ref, `N.(Trt1)`, `N.(Trt2)`)) %>%
select(-c(name, `N.(Trt1)`, `N.(Trt2)`))
}
df <- gen_network_data(data, ref)
plot(df)
OS_network <- df %>%
filter(Reported.OS == 1) %>%
gen_network(ref)
OS_network <- df %>%
filter(Reported.OS == 1) %>%
gen_network(ref) %>%
plot()
OS_network <- df %>%
filter(Reported.OS == 1) %>%
gen_network(ref)
plot(OS_network)
PFS_network <- df %>%
filter(Reported.PFS == 1) %>%
gen_network(ref)
plot(PFS_network)
plot_network <- function(network, ...){
ggraph(as.igraph(network), layout = "kk") +
geom_edge_fan(aes(edge_width = .data$.nstudy)) +
scale_edge_width_continuous("Number of Studies") +
geom_node_point(aes()) +
geom_node_text(aes(label = .data$name))
}
plot_network(OS_network)
plot(OS_network)
plot(PFS_network)
plot(PFS_network)
OS_network
?multinma::nma
df
View(df)
length(unique(df))
length(unique(df$Study))
PFS_network
OS_network
plot(OS_network)
plot(PFS_network)
View(df)
View(df)
